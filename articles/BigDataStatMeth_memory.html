<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="BigDataStatMeth">
<title>Matrix operations, algebra and Statistical Methods for Big Data. Part I: working in memory â€¢ BigDataStatMeth</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Matrix operations, algebra and Statistical Methods for Big Data. Part I: working in memory">
<meta property="og:description" content="BigDataStatMeth">
<meta property="og:image" content="https://dpelegri.github.io/BigDataStatMeth/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BigDataStatMeth</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.50</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/BigDataStatMeth_hdf5.html">Matrix operations, algebra and Statistical Methods for Big Data. Part II: working with HDF5 files</a>
    <a class="dropdown-item" href="../articles/BigDataStatMeth_memory.html">Matrix operations, algebra and Statistical Methods for Big Data. Part I: working in memory</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="http://twitter.com/brgelab" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Matrix operations, algebra and Statistical Methods for Big Data. Part I: working in memory</h1>
                        <h4 data-toc-skip class="author">Dolors
Pelegri</h4>
            <address class="author_afil">
      Universitat de Barcelona - Universitat de Barcelona (UAB)ISGlobal,
Centre for Research in Environmental Epidemiology
(ISGlobal)Bioinformatics Research Group in Epidemiolgy
(BRGE)<br><h4 data-toc-skip class="author">Juan
R. Gonzalez</h4>
            <address class="author_afil">
      Universitat de Barcelona - Universitat de Barcelona (UAB)ISGlobal,
Centre for Research in Environmental Epidemiology
(ISGlobal)Bioinformatics Research Group in Epidemiolgy
(BRGE)<br><a class="author_email" href="mailto:#"></a><a href="mailto:juanr.gonzalez@isglobal.org" class="email">juanr.gonzalez@isglobal.org</a>
      </address>
                  
            <h4 data-toc-skip class="date">2022-10-25</h4>
      
      
      <div class="d-none name"><code>BigDataStatMeth_memory.Rmd</code></div>
    </address>
</div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>Description of functions to perform matrix operations, algebra
      and some basic statistical models using <em>Matrix</em> (CRAN)
      objects.</p>
    </div>
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This package implements several matrix operations using
<code>Matrix</code> and <code>DelayMatrix</code> objects as well as HDF5
data files. Some basic algebra operations that can also be computed that
are useful to implement statistical analyses using standard
methodologies such as principal component analyses (PCA) or least
squares estimation. The package also contains specific statistical
methods mainly used in <code>omic</code> data analysis such as lasso
regression. All procedures referred to HDF5 can be found in <a href="https://github.com/isglobal-brge/BigDataStatMeth/blob/master/vignettes/BigDataStatMeth_hdf5.html" class="external-link">BigDataStatMeth_hdf5</a>
vignette.</p>
</div>
<div class="section level2">
<h2 id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h2>
<p>The package requires other packages from <code>CRAN</code> and
<code>Bioconductor</code> to be installed.</p>
<ul>
<li>
<code>CRAN</code>: <code>Matrix</code>, <code>RcppEigen</code> and
<code>RSpectra</code>.</li>
</ul>
<p>As the package can also deal with <a href="https://www.hdfgroup.org/solutions/hdf5/" class="external-link">hdf5 files</a> [See
Vignette <a href="https://github.com/isglobal-brge/BigDataStatMeth/blob/master/vignettes/BigDataStatMeth_hdf5.html" class="external-link">BigDataStatMeth_hdf5</a>],
these other packages are required: <code>HDF5Array</code>,
<code>rhdf5</code>. The user can execute this code to install the
required packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install BiocManager (if not previously installed)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Install required packages</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html" class="external-link">install</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Matrix"</span>, <span class="st">"RcppEigen"</span>, <span class="st">"RSpectra"</span>, <span class="st">"DelayedArray"</span>,</span>
<span>                       <span class="st">"HDF5Array"</span>, <span class="st">"rhdf5"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Our package needs to be installed from source code. In such cases, a
collection of software (e.g.Â C, C++, Fortran, etc.) are required, mainly
for Windows users. These programs can be installed using <a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link">Rtools</a>.</p>
</div>
<div class="section level2">
<h2 id="install-package">Install package<a class="anchor" aria-label="anchor" href="#install-package"></a>
</h2>
<p>Once required packages and Rtools are installed,
<code>BigDataStatMeth</code> package can be installed from our GitHub
repository as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install devtools and load library (if not previously installed)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install BigDataStatMeth </span></span>
<span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"isglobal-brge/BigDataStatMeth"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>First, let us start by loading the required packages to describe the
main capabilities of the package</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://Matrix.R-forge.R-project.org/" class="external-link">Matrix</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">BigDataStatMeth</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p>This packages is also required to reproduce this vignette</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshuaulrich/microbenchmark/" class="external-link">microbenchmark</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="matrix-multiplication">Matrix Multiplication<a class="anchor" aria-label="anchor" href="#matrix-multiplication"></a>
</h2>
<p>In this section, different products of matrices and vectors are
introduced. The methods implement different strategies including block
multiplication algorithms and the use of parallel implementations.</p>
<div class="section level3">
<h3 id="block-matrix-multiplication">Block matrix multiplication<a class="anchor" aria-label="anchor" href="#block-matrix-multiplication"></a>
</h3>
<p>A block matrix or a partitioned matrix is a matrix that is
interpreted as having been broken into sections called blocks or
submatrices. Intuitively, a block matrix can be visualized as the
original matrix with a collection of horizontal and vertical lines,
which break it up, or partition it, into a collection of smaller
matrices. the implementation has been made from the adaptation of the
Fox algorithm <a href="#id_1">[1]</a>.</p>
<p><span class="math display">\[A*B=\begin{pmatrix}
{A}_{11}&amp;{A}_{12} \\
{A}_{21}&amp;{A}_{22}\end{pmatrix}*\begin{pmatrix}{B}_{11}&amp;B_{12}\\B_{21}&amp;B_{22}\end{pmatrix}=\begin{pmatrix}{C}_{11}&amp;C_{12}\\C_{21}&amp;C_{22}\end{pmatrix}=C\]</span></p>
<p>Let us simulate to set of matrices to illustrate the use of the
function accross the entire documment. First, we simulate a simple case
with to matrices A and B with dimensions 500x500 and 500x750,
respectively. Second, another example with dimensions 1000x10000 are use
to evaluate the performance in large matrices. The examples with big
datasets will be illustrated using real data belonging to different omic
settings. We can simulate to matrices with the desired dimensions by</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Define small matrix A and B</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123456</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">750</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">n</span><span class="op">)</span>, nrow<span class="op">=</span><span class="va">n</span>, ncol<span class="op">=</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>, nrow<span class="op">=</span><span class="va">n</span>, ncol<span class="op">=</span><span class="va">p</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Define big matrix Abig and Bbig</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span>
<span><span class="va">Abig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">n</span><span class="op">)</span>, nrow<span class="op">=</span><span class="va">n</span>, ncol<span class="op">=</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">Bbig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>, nrow<span class="op">=</span><span class="va">n</span>, ncol<span class="op">=</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
<p>Matrix multiplication using block matrices is implemented in the
<code><a href="../reference/bdblockmult.html">bdblockmult()</a></code> function. It only requires to setting the
argument <code>block_size</code>, by default
<code>block_size = 128</code>. An optimal block size is important to
better performance but it is difficult to asses what is the optimum
block size for each matrix.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use 10x10 blocks</span></span>
<span><span class="va">AxB</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bdblockmult.html">bdblockmult</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">B</span>, block_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>As expected the results obtained using this procedure are the correct
ones</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(AxB, A<span class="sc">%*%</span>B)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
<p>Note that when the argument <code>block_size</code> is larger than
any of the dimensions of matrix A or B the <code>blocks_size</code> is
set to <code>min(cols(A), rows(A), cols(B), rows(B))</code>.</p>
<p>The process can be speed up by making computations in parallel using
<code>paral=TRUE</code> an optional parameter threads can be used to
indicate the number of <code>threads</code> to launch simultaneously, if
<code>threads=NULL</code> the function takes the available threads - 1,
leaving one available for user.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>AxB <span class="ot">&lt;-</span> <span class="fu">bdblockmult</span>(A, B, <span class="at">block_size =</span> <span class="dv">10</span>, <span class="at">paral =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(AxB,A<span class="sc">%*%</span>B)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
<p>To work with big matrices <code><a href="../reference/bdblockmult.html">bdblockmult()</a></code> can save
matrices in hdf5 file format in order to be able to operate with them in
blocks and not overload the memory, by default are considered large
matrices if the number of rows or columns is greater than 5000, but it
can be changed with <code>bigmatrix</code> argument. Or we can also
force to execute the matrix multiplication with data on memory setting
the parameter <code>onmemory = TRUE</code></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We want to force it to run in memory</span></span>
<span><span class="va">AxBNOBig</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bdblockmult.html">bdblockmult</a></span><span class="op">(</span><span class="va">Abig</span>, <span class="va">Bbig</span>, onmemory <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Run matrix multiplication with data on memory using submatrices of 256x256</span></span>
<span><span class="va">AxBBig3000</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bdblockmult.html">bdblockmult</a></span><span class="op">(</span><span class="va">Abig</span>, <span class="va">Bbig</span>, block_size <span class="op">=</span> <span class="fl">256</span> , onmemory <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Here, we compare the performance of the block method with the
different options.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>bench1 <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>( </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Parallel block size = 128</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Paral128Mem =</span> <span class="fu">bdblockmult</span>(Abig, Bbig, <span class="at">paral =</span> <span class="cn">TRUE</span>), </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># On disk parallel block size = 256</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Paral256Disk =</span> <span class="fu">bdblockmult</span>(Abig, Bbig, <span class="at">block_size=</span><span class="dv">256</span>, <span class="at">paral=</span><span class="cn">TRUE</span>), </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Paral256Mem =</span> <span class="fu">bdblockmult</span>(Abig, Bbig, <span class="at">block_size=</span><span class="dv">256</span>, </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">paral=</span><span class="cn">TRUE</span>, <span class="at">onmemory=</span><span class="cn">TRUE</span>),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Paral1024Mem =</span> <span class="fu">bdblockmult</span>(Abig, Bbig, <span class="at">block_size=</span><span class="dv">1024</span>, </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">paral=</span><span class="cn">TRUE</span>, <span class="at">onmemory=</span><span class="cn">TRUE</span>), <span class="at">times =</span> <span class="dv">3</span> )</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>Warning <span class="cf">in</span> <span class="fu">microbenchmark</span>(<span class="at">Paral128Mem =</span> <span class="fu">bdblockmult</span>(Abig, Bbig, <span class="at">paral =</span> <span class="cn">TRUE</span>), <span class="sc">:</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>less accurate nanosecond times to avoid potential integer overflows</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>bench1</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>Unit<span class="sc">:</span> milliseconds</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>         expr      min       lq     mean   median       uq      max neval</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  Paral128Mem <span class="fl">548.1470</span> <span class="fl">548.3064</span> <span class="fl">549.1037</span> <span class="fl">548.4658</span> <span class="fl">549.5820</span> <span class="fl">550.6982</span>     <span class="dv">3</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a> Paral256Disk <span class="fl">528.1665</span> <span class="fl">528.4058</span> <span class="fl">529.4617</span> <span class="fl">528.6451</span> <span class="fl">530.1093</span> <span class="fl">531.5735</span>     <span class="dv">3</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  Paral256Mem <span class="fl">389.0148</span> <span class="fl">389.0231</span> <span class="fl">389.8172</span> <span class="fl">389.0315</span> <span class="fl">390.2184</span> <span class="fl">391.4053</span>     <span class="dv">3</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a> Paral1024Mem <span class="fl">389.5812</span> <span class="fl">390.4802</span> <span class="fl">391.9731</span> <span class="fl">391.3792</span> <span class="fl">393.1691</span> <span class="fl">394.9591</span>     <span class="dv">3</span></span></code></pre></div>
<p>We can observe that the shortest execution time is achieved with
<code>block_size = 256</code>. The same information is depicted in the
next Figure which illustrates the comparison between the different
assessed methods</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">bench1</span><span class="op">)</span></span></code></pre></div>
<p><img src="BigDataStatMeth_memory_files/figure-html/plotbench2-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="sparse-matrix-multiplication">Sparse matrix multiplication<a class="anchor" aria-label="anchor" href="#sparse-matrix-multiplication"></a>
</h3>
<p>A sparse matrix or sparse array is a matrix in which most of the
elements are zero. <code>BigDataStatMeth</code> allows to perform matrix
multiplication with sparse matrices using the function
<code>bdblockmult_sparse</code>. It is necessary that at least one of
the the two matrices is defined as sparse in R using
<code>dgCMatrix</code> class. An example of a sparse matrix could be
:</p>
<p><span class="math display">\[\begin{equation}
  \begin{bmatrix}
    a_{11}&amp;a_{12} &amp; 0 &amp; \cdots &amp; \cdots &amp; \cdots
&amp; \cdots &amp; 0 \\
    a_{21}  &amp; a_{22}  &amp; a_{23}  &amp; \ddots &amp; &amp;&amp;
&amp; \vdots \\
    0 &amp; a_{32}  &amp; a_{33} &amp; a_{34}  &amp; \ddots &amp;
&amp;  &amp; \vdots \\
    \vdots &amp; \ddots &amp; \ddots &amp; \ddots &amp; \ddots &amp;
\ddots &amp;  &amp; \vdots \\
    \vdots &amp; &amp; \ddots &amp; \ddots &amp; \ddots &amp; \ddots
&amp; \ddots&amp; \vdots\\
    \vdots  &amp;  &amp; &amp; &amp; \ddots &amp; a_{n-1,n-2}  &amp;
a_{n-1,n-1}  &amp;  a_{n-1,n}\\
    0 &amp; \cdots &amp;  \cdots &amp; \cdots &amp; \cdots &amp; 0 &amp;
a_{n,n-1} &amp; a_{n,n}  \\
  \end{bmatrix}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate 2 sparse matrix x_sparse and y_sparse</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>x_sparse <span class="ot">&lt;-</span> <span class="fu">sparseMatrix</span>(</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>   <span class="at">i =</span> <span class="fu">sample</span>(<span class="at">x =</span> k, <span class="at">size =</span> k),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>   <span class="at">j =</span> <span class="fu">sample</span>(<span class="at">x =</span> k, <span class="at">size =</span> k),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>   <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> k)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>y_sparse <span class="ot">&lt;-</span> <span class="fu">sparseMatrix</span>(</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>   <span class="at">i =</span> <span class="fu">sample</span>(<span class="at">x =</span> k, <span class="at">size =</span> k),</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>   <span class="at">j =</span> <span class="fu">sample</span>(<span class="at">x =</span> k, <span class="at">size =</span> k),</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>   <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> k)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">bdblockmult_sparse</span>(x_sparse, y_sparse)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> x_sparse<span class="sc">%*%</span>y_sparse</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(d,f)</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
<p>Here, we compare the performace using sparse matrix multiplication
with sparse matrices and the blockmult multiplication with the same
matrices not declared as sparce.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>( </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">sparse_mult =</span> <span class="fu">bdblockmult_sparse</span>(x_sparse, y_sparse),</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">matrix_mult =</span> <span class="fu">bdblockmult</span>(<span class="fu">as.matrix</span>(x_sparse), <span class="fu">as.matrix</span>(y_sparse)), </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">RSparse_mult =</span> x_sparse<span class="sc">%*%</span> y_sparse, </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">times =</span> <span class="dv">3</span> )</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>res</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>Unit<span class="sc">:</span> microseconds</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>         expr         min          lq         mean      median           uq</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  sparse_mult     <span class="fl">399.094</span>     <span class="fl">406.392</span>     <span class="fl">422.3137</span>     <span class="fl">413.690</span>     <span class="fl">433.9235</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  matrix_mult <span class="fl">3749933.841</span> <span class="fl">3751146.006</span> <span class="fl">3751611.1100</span> <span class="fl">3752358.171</span> <span class="fl">3752449.7445</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a> RSparse_mult      <span class="fl">98.687</span>     <span class="fl">100.122</span>     <span class="fl">130.6807</span>     <span class="fl">101.557</span>     <span class="fl">146.6775</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>         max neval</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>     <span class="fl">454.157</span>     <span class="dv">3</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a> <span class="fl">3752541.318</span>     <span class="dv">3</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>     <span class="fl">191.798</span>     <span class="dv">3</span></span></code></pre></div>
<p>The same information is depicted in the next Figure which illustrates
the comparison between the different assessed methods</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p><img src="BigDataStatMeth_memory_files/figure-html/plotbench3-1.png" width="700"></p>
<p>We can observe the huge difference in execution time</p>
</div>
</div>
<div class="section level2">
<h2 id="cross-product-and-transposed-cross-product">Cross-product and Transposed Cross-product<a class="anchor" aria-label="anchor" href="#cross-product-and-transposed-cross-product"></a>
</h2>
<p>To perform a cross-product and tcrossproduct with BigDataStatMeth we
use the same function <code>bdcrossprod()</code> setting parameter
<code>transposed</code> to TRUE or FALSE. Like other functions
implemented in BigDataStatMeth, we can work with R Objects. Setting
parameter transposed for Crossproduct and tCrossProduct</p>
<ul>
<li><p>if <code>transposed = FALSE</code> (default), we perform a
Crossproduct <span class="math display">\[\left( C \right) ={ \left( A
\right)  }^{ t }\left( A \right) \]</span></p></li>
<li><p>if <code>transposed = TRUE</code> : we perform a
transposed-Crossproduct <span class="math display">\[\left( C \right) =
\left( A \right){ \left( A \right)  }^{ t } \]</span></p></li>
</ul>
<p>Here we shown some examples using <code>bdcrossprod</code>
function</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">250</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">m</span><span class="op">)</span>, nrow<span class="op">=</span><span class="va">n</span>, ncol<span class="op">=</span><span class="va">m</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Cross Product of a standard R matrix</span></span>
<span><span class="va">cpA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bdCrossprod.html">bdCrossprod</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span></code></pre></div>
<p>We obtain the expected values computed using <code>crossprod</code> R
function</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(cpA, <span class="fu">crossprod</span>(A))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
<p>you may also set <code>transposed=TRUE</code></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Transposed Cross Product R matrices</span></span>
<span><span class="va">tcpA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bdtCrossprod.html">bdtCrossprod</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span></code></pre></div>
<p>We obtain the expected values computed using <code>tcrossprod</code>
function</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(tcpA, <span class="fu">tcrossprod</span>(A))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
<p>We can show that the implemented version really improves the R
implementation computational speed.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">bdcrossp_tr =</span> <span class="fu">bdtCrossprod</span>(A),</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">rcrossp_tr =</span> <span class="fu">tcrossprod</span>(A),</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">bdcrossp =</span> <span class="fu">bdCrossprod</span>(A),</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">rcrossp =</span> <span class="fu">crossprod</span>(A),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">times =</span> <span class="dv">3</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>res</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>Unit<span class="sc">:</span> milliseconds</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>        expr       min        lq      mean    median        uq       max neval</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a> bdcrossp_tr <span class="fl">117.58673</span> <span class="fl">117.94007</span> <span class="fl">118.25976</span> <span class="fl">118.29341</span> <span class="fl">118.59627</span> <span class="fl">118.89914</span>     <span class="dv">3</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  rcrossp_tr  <span class="fl">11.20136</span>  <span class="fl">11.26596</span>  <span class="fl">11.30939</span>  <span class="fl">11.33056</span>  <span class="fl">11.36340</span>  <span class="fl">11.39624</span>     <span class="dv">3</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    bdcrossp  <span class="fl">60.74876</span>  <span class="fl">60.85232</span>  <span class="fl">60.92720</span>  <span class="fl">60.95589</span>  <span class="fl">61.01643</span>  <span class="fl">61.07696</span>     <span class="dv">3</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>     rcrossp  <span class="fl">16.69590</span>  <span class="fl">16.75650</span>  <span class="fl">16.78976</span>  <span class="fl">16.81709</span>  <span class="fl">16.83669</span>  <span class="fl">16.85629</span>     <span class="dv">3</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p><img src="BigDataStatMeth_memory_files/figure-html/plotbenchmark_bdcrossprod-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="matrix-vector-multiplication">Matrix Vector Multiplication<a class="anchor" aria-label="anchor" href="#matrix-vector-multiplication"></a>
</h2>
<p>You can perform a weighted cross-product <span class="math inline">\(C = X^ t w X\)</span> with
<code>bdwcrossprod()</code> given a matrix X as argument and a vector or
matrix of weights, w.</p>
<div class="section level3">
<h3 id="weighted-cross-product-and-weighted-transposed-cross-product">Weighted Cross-product and Weighted Transposed Cross-product<a class="anchor" aria-label="anchor" href="#weighted-cross-product-and-weighted-transposed-cross-product"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">250</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n<span class="sc">*</span>n), <span class="at">nrow=</span>n, <span class="at">ncol=</span>n)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> u <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> u)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>wcpX <span class="ot">&lt;-</span> <span class="fu">bdwproduct</span>(X, w,<span class="st">"xwxt"</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>wcpX[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>           [,<span class="dv">1</span>]       [,<span class="dv">2</span>]       [,<span class="dv">3</span>]       [,<span class="dv">4</span>]      [,<span class="dv">5</span>]</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,] <span class="fl">41.8137240</span>  <span class="fl">4.0688017</span> <span class="sc">-</span><span class="fl">3.5551601</span> <span class="sc">-</span><span class="fl">0.9590417</span> <span class="sc">-</span><span class="fl">3.649829</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,]  <span class="fl">4.0688017</span> <span class="fl">35.8957169</span>  <span class="fl">0.4522855</span> <span class="sc">-</span><span class="fl">3.6490462</span>  <span class="fl">3.866538</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span>,] <span class="sc">-</span><span class="fl">3.5551601</span>  <span class="fl">0.4522855</span> <span class="fl">44.5225035</span>  <span class="fl">2.3956115</span>  <span class="fl">5.998364</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">4</span>,] <span class="sc">-</span><span class="fl">0.9590417</span> <span class="sc">-</span><span class="fl">3.6490462</span>  <span class="fl">2.3956115</span> <span class="fl">36.3507446</span> <span class="sc">-</span><span class="fl">2.287474</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>[<span class="dv">5</span>,] <span class="sc">-</span><span class="fl">3.6498289</span>  <span class="fl">3.8665378</span>  <span class="fl">5.9983636</span> <span class="sc">-</span><span class="fl">2.2874736</span> <span class="fl">42.947037</span></span></code></pre></div>
<p>Those are the expected values as it is indicated by executing:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>( wcpX, X<span class="sc">%*%</span><span class="fu">diag</span>(w)<span class="sc">%*%</span><span class="fu">t</span>(X) )</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="weighted-transposed-cross-product">Weighted Transposed Cross Product<a class="anchor" aria-label="anchor" href="#weighted-transposed-cross-product"></a>
</h3>
<p>With argument <code>transposed=TRUE</code>, we can perform a
transposed weighted cross-product <span class="math inline">\(C = A w
A^t\)</span></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>wtcpX <span class="ot">&lt;-</span> <span class="fu">bdwproduct</span>(X, w,<span class="st">"xtwx"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>wtcpX[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>          [,<span class="dv">1</span>]        [,<span class="dv">2</span>]      [,<span class="dv">3</span>]        [,<span class="dv">4</span>]      [,<span class="dv">5</span>]</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,] <span class="fl">44.319669</span>  <span class="fl">4.02108694</span> <span class="sc">-</span><span class="fl">3.006229</span> <span class="sc">-</span><span class="fl">1.85345133</span> <span class="sc">-</span><span class="fl">3.786994</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,]  <span class="fl">4.021087</span> <span class="fl">38.82933816</span> <span class="sc">-</span><span class="fl">3.638959</span> <span class="sc">-</span><span class="fl">0.03011039</span> <span class="sc">-</span><span class="fl">3.451078</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span>,] <span class="sc">-</span><span class="fl">3.006229</span> <span class="sc">-</span><span class="fl">3.63895884</span> <span class="fl">47.303628</span> <span class="sc">-</span><span class="fl">3.16577769</span>  <span class="fl">2.629315</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">4</span>,] <span class="sc">-</span><span class="fl">1.853451</span> <span class="sc">-</span><span class="fl">0.03011039</span> <span class="sc">-</span><span class="fl">3.165778</span> <span class="fl">40.87522997</span>  <span class="fl">2.700950</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">5</span>,] <span class="sc">-</span><span class="fl">3.786994</span> <span class="sc">-</span><span class="fl">3.45107802</span>  <span class="fl">2.629315</span>  <span class="fl">2.70094954</span> <span class="fl">41.088084</span></span></code></pre></div>
<p>Those are the expected values as it is indicated by executing:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(wtcpX, <span class="fu">t</span>(X)<span class="sc">%*%</span><span class="fu">diag</span>(w)<span class="sc">%*%</span>X)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="inverse-cholesky">Inverse Cholesky<a class="anchor" aria-label="anchor" href="#inverse-cholesky"></a>
</h2>
<p>The Cholesky factorization is widely used for solving a system of
linear equations whose coefficient matrix is symmetric and positive
definite.</p>
<p><span class="math display">\[A = LL^t = U^tU\]</span></p>
<p>where <span class="math inline">\(L\)</span> is a lower triangular
matrix and U is an upper triangular matrix. To get the Inverse Cholesky
we can use the function <code><a href="../reference/bdInvCholesky.html">bdInvCholesky()</a></code>. Let us start by
illustrating how to do this computations in a simulated data:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a positive definite matrix</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>Posdef <span class="ot">&lt;-</span> <span class="cf">function</span> (n, <span class="at">ev =</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">ncol=</span>n, <span class="fu">rnorm</span>(n<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  decomp <span class="ot">&lt;-</span> <span class="fu">qr</span>(Z)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  Q <span class="ot">&lt;-</span> <span class="fu">qr.Q</span>(decomp)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  R <span class="ot">&lt;-</span> <span class="fu">qr.R</span>(decomp)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">diag</span>(R)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  ph <span class="ot">&lt;-</span> d <span class="sc">/</span> <span class="fu">abs</span>(d)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  O <span class="ot">&lt;-</span> Q <span class="sc">%*%</span> <span class="fu">diag</span>(ph)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> <span class="fu">t</span>(O) <span class="sc">%*%</span> <span class="fu">diag</span>(ev) <span class="sc">%*%</span> O</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Z)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">Posdef</span>(<span class="at">n =</span> <span class="dv">500</span>, <span class="at">ev =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>invchol <span class="ot">&lt;-</span> <span class="fu">bdInvCholesky</span>(A)</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(invchol[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>],<span class="dv">8</span>)</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>            [,<span class="dv">1</span>]        [,<span class="dv">2</span>]        [,<span class="dv">3</span>]        [,<span class="dv">4</span>]        [,<span class="dv">5</span>]</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,]  <span class="fl">0.01068322</span> <span class="sc">-</span><span class="fl">0.00063371</span> <span class="sc">-</span><span class="fl">0.00104697</span>  <span class="fl">0.00230612</span> <span class="sc">-</span><span class="fl">0.00173745</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,] <span class="sc">-</span><span class="fl">0.00063371</span>  <span class="fl">0.00845418</span>  <span class="fl">0.00029448</span> <span class="sc">-</span><span class="fl">0.00104800</span>  <span class="fl">0.00020868</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span>,] <span class="sc">-</span><span class="fl">0.00104697</span>  <span class="fl">0.00029448</span>  <span class="fl">0.00878553</span> <span class="sc">-</span><span class="fl">0.00074755</span>  <span class="fl">0.00006907</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>[<span class="dv">4</span>,]  <span class="fl">0.00230612</span> <span class="sc">-</span><span class="fl">0.00104800</span> <span class="sc">-</span><span class="fl">0.00074755</span>  <span class="fl">0.02041952</span>  <span class="fl">0.00020405</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>[<span class="dv">5</span>,] <span class="sc">-</span><span class="fl">0.00173745</span>  <span class="fl">0.00020868</span>  <span class="fl">0.00006907</span>  <span class="fl">0.00020405</span>  <span class="fl">0.01137916</span></span></code></pre></div>
<p>We can check whether this function returns the expected values
obtained with the standard R function <code>solve</code>:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(invchol, <span class="fu">solve</span>(A))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
<p>We can show that the implemented version really improves the R
implementation computational speed.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">invchol =</span> <span class="fu">bdInvCholesky</span>(A),</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">invcholR =</span> <span class="fu">solve</span>(A),</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">times =</span> <span class="dv">3</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>res</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Unit<span class="sc">:</span> milliseconds</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>     expr      min        lq      mean    median        uq       max neval</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  invchol <span class="fl">717.0209</span> <span class="fl">718.93808</span> <span class="fl">721.40196</span> <span class="fl">720.85523</span> <span class="fl">723.59248</span> <span class="fl">726.32972</span>     <span class="dv">3</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a> invcholR  <span class="fl">52.9793</span>  <span class="fl">53.40533</span>  <span class="fl">53.62033</span>  <span class="fl">53.83136</span>  <span class="fl">53.94085</span>  <span class="fl">54.05034</span>     <span class="dv">3</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p><img src="BigDataStatMeth_memory_files/figure-html/plotbenchmark_invChol-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="pseudo-inverse">Pseudo-Inverse<a class="anchor" aria-label="anchor" href="#pseudo-inverse"></a>
</h2>
<p>The Moore-Penrose pseudoinverse is a direct application of the SVD.
The inverse of a matrix A can be used to solve the equation <span class="math inline">\({Ax}={b}\)</span>. But in the case where the set
of equations have 0 or many solutions the inverse cannot be found and
the equation cannot be solved. The following formula is used to find the
pseudoinverse: <span class="math display">\[{A}^+= {VD}^+{U}^T\]</span>
In BigDataStatMeth we implemented Moore-Penrose pseudoinverse in
function <code>bdpseudoinv</code>, now we get the pseudoinverse from a
simulated data</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">800</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">700</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n<span class="sc">*</span>m), <span class="at">nrow=</span>n, <span class="at">ncol=</span>m)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>pseudoinv <span class="ot">&lt;-</span> <span class="fu">bdpseudoinv</span>(A)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="fu">zapsmall</span>(pseudoinv)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>             [,<span class="dv">1</span>]         [,<span class="dv">2</span>]         [,<span class="dv">3</span>]         [,<span class="dv">4</span>]         [,<span class="dv">5</span>]</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,] <span class="sc">-</span><span class="fl">0.007071901</span> <span class="sc">-</span><span class="fl">0.000193207</span> <span class="sc">-</span><span class="fl">0.004785558</span>  <span class="fl">0.000175308</span> <span class="sc">-</span><span class="fl">0.002338808</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,] <span class="sc">-</span><span class="fl">0.003226277</span>  <span class="fl">0.003972747</span>  <span class="fl">0.006872109</span>  <span class="fl">0.001231256</span> <span class="sc">-</span><span class="fl">0.004644404</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span>,] <span class="sc">-</span><span class="fl">0.009594353</span>  <span class="fl">0.006160482</span> <span class="sc">-</span><span class="fl">0.004336592</span> <span class="sc">-</span><span class="fl">0.001425284</span>  <span class="fl">0.001542341</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">4</span>,]  <span class="fl">0.004479327</span>  <span class="fl">0.000841558</span>  <span class="fl">0.001757631</span> <span class="sc">-</span><span class="fl">0.004109301</span>  <span class="fl">0.007519060</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>[<span class="dv">5</span>,] <span class="sc">-</span><span class="fl">0.000418443</span> <span class="sc">-</span><span class="fl">0.001207001</span>  <span class="fl">0.003596909</span>  <span class="fl">0.006295424</span> <span class="sc">-</span><span class="fl">0.001892957</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="qr-factorization">QR Factorization<a class="anchor" aria-label="anchor" href="#qr-factorization"></a>
</h2>
<p>QR decomposition, also known as a QR factorization or QU
factorization is a decomposition of a matrix A into a product : <span class="math display">\[A = QR\]</span> of an orthogonal matrix Q and an
upper triangular matrix R. QR decomposition is often used to solve the
linear least squares problems.</p>
<p>In BigDataStatMeth we implemented QR decomposition in function
<code>bdQR</code>, the QR decomposition can be performed in R objects.
To show how to use this function we performa a QR decomposition from the
previous simulated data in matrix A.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>QR_A <span class="ot">&lt;-</span> <span class="fu">bdQR</span>(A)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>QR_R <span class="ot">&lt;-</span> <span class="fu">qr</span>(A)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Show results for Q</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="fu">zapsmall</span>(QR_A<span class="sc">$</span>Q[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>            [,<span class="dv">1</span>]        [,<span class="dv">2</span>]        [,<span class="dv">3</span>]        [,<span class="dv">4</span>]        [,<span class="dv">5</span>]</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,] <span class="sc">-</span><span class="fl">0.09751413</span>  <span class="fl">0.05476439</span> <span class="sc">-</span><span class="fl">0.06324176</span>  <span class="fl">0.00402516</span>  <span class="fl">0.01736904</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,]  <span class="fl">0.01408272</span> <span class="sc">-</span><span class="fl">0.03307061</span> <span class="sc">-</span><span class="fl">0.00410891</span> <span class="sc">-</span><span class="fl">0.01779408</span>  <span class="fl">0.09215147</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span>,] <span class="sc">-</span><span class="fl">0.05313533</span> <span class="sc">-</span><span class="fl">0.05819508</span> <span class="sc">-</span><span class="fl">0.03771256</span>  <span class="fl">0.01765984</span> <span class="sc">-</span><span class="fl">0.05703391</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>[<span class="dv">4</span>,] <span class="sc">-</span><span class="fl">0.04576630</span> <span class="sc">-</span><span class="fl">0.01599696</span> <span class="sc">-</span><span class="fl">0.00297678</span> <span class="sc">-</span><span class="fl">0.01702504</span> <span class="sc">-</span><span class="fl">0.01524199</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">5</span>,] <span class="sc">-</span><span class="fl">0.01079994</span>  <span class="fl">0.01674268</span>  <span class="fl">0.00374898</span> <span class="sc">-</span><span class="fl">0.01934687</span> <span class="sc">-</span><span class="fl">0.04035167</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Show results for R</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="fu">zapsmall</span>(QR_A<span class="sc">$</span>R[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>         [,<span class="dv">1</span>]       [,<span class="dv">2</span>]      [,<span class="dv">3</span>]      [,<span class="dv">4</span>]       [,<span class="dv">5</span>]</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,] <span class="fl">25.85659</span>   <span class="fl">0.431968</span>  <span class="fl">0.048283</span>  <span class="fl">1.880904</span>   <span class="fl">0.253994</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,]  <span class="fl">0.00000</span> <span class="sc">-</span><span class="fl">27.514698</span>  <span class="fl">2.341086</span>  <span class="fl">0.189451</span>  <span class="sc">-</span><span class="fl">0.667984</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span>,]  <span class="fl">0.00000</span>   <span class="fl">0.000000</span> <span class="fl">26.936966</span> <span class="sc">-</span><span class="fl">0.471915</span>   <span class="fl">0.065189</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>[<span class="dv">4</span>,]  <span class="fl">0.00000</span>   <span class="fl">0.000000</span>  <span class="fl">0.000000</span> <span class="fl">26.732846</span>   <span class="fl">1.240861</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>[<span class="dv">5</span>,]  <span class="fl">0.00000</span>   <span class="fl">0.000000</span>  <span class="fl">0.000000</span>  <span class="fl">0.000000</span> <span class="sc">-</span><span class="fl">25.773455</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Q </span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(QR_A<span class="sc">$</span>Q, <span class="fu">qr.Q</span>(QR_R), <span class="at">check.attributes=</span><span class="cn">FALSE</span>)</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="solve-matrix-equation">Solve matrix equation<a class="anchor" aria-label="anchor" href="#solve-matrix-equation"></a>
</h2>
<p>In BigDataStatMeth we implemented the function <code>bdSolve</code>
that computes the solution to a real system of linear equations</p>
<p><span class="math display">\[A*X = B\]</span> where A is an N-by-N
matrix and X and B are N-by-K matrices.</p>
<p>Here we solve a matrix equation with a squared matrix A (1000 by
1000) and B matrix (1000 by 2)</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate data</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(n<span class="sc">*</span>m), <span class="at">nrow =</span> n, <span class="at">ncol =</span> m)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(n<span class="sc">*</span><span class="dv">2</span>), <span class="at">nrow =</span> n)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve matrix equation</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">bdSolve</span>(A, B)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Show results</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,]</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>           [,<span class="dv">1</span>]       [,<span class="dv">2</span>]</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,]  <span class="fl">11.739756</span>   <span class="fl">8.287620</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,]  <span class="fl">13.687967</span>  <span class="fl">11.358812</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span>,]   <span class="fl">3.495741</span>   <span class="fl">1.990773</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>[<span class="dv">4</span>,] <span class="sc">-</span><span class="fl">16.500408</span> <span class="sc">-</span><span class="fl">10.906902</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>[<span class="dv">5</span>,]  <span class="sc">-</span><span class="fl">7.406204</span>  <span class="sc">-</span><span class="fl">5.414059</span></span></code></pre></div>
<p>Now we check results multiplying matrix A by results X, if all is
correct <span class="math inline">\(A*X = B\)</span></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>testB <span class="ot">&lt;-</span> <span class="fu">bdblockmult</span>(A,X)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>B[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,]</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>          [,<span class="dv">1</span>]      [,<span class="dv">2</span>]</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,] <span class="fl">0.9572424</span> <span class="fl">0.3966286</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,] <span class="fl">0.4503205</span> <span class="fl">0.9293827</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span>,] <span class="fl">0.3437463</span> <span class="fl">0.7550047</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">4</span>,] <span class="fl">0.4054374</span> <span class="fl">0.6855674</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">5</span>,] <span class="fl">0.7638437</span> <span class="fl">0.7139061</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>testB[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,]</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>          [,<span class="dv">1</span>]      [,<span class="dv">2</span>]</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,] <span class="fl">0.9572424</span> <span class="fl">0.3966286</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,] <span class="fl">0.4503205</span> <span class="fl">0.9293827</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span>,] <span class="fl">0.3437463</span> <span class="fl">0.7550047</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>[<span class="dv">4</span>,] <span class="fl">0.4054374</span> <span class="fl">0.6855674</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>[<span class="dv">5</span>,] <span class="fl">0.7638437</span> <span class="fl">0.7139061</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(B, testB)</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="singular-value-decomposition-svd">Singular Value Decomposition (SVD)<a class="anchor" aria-label="anchor" href="#singular-value-decomposition-svd"></a>
</h2>
<p>The SVD of an <span class="math inline">\(m \times n\)</span> real or
complex matrix <span class="math inline">\(A\)</span> is a factorization
of the form:</p>
<p><span class="math display">\[U\Sigma { V }^{ T }\]</span></p>
<p>where :</p>
<p>-<span class="math inline">\(U\)</span> is a <span class="math inline">\(m \times m\)</span> real or complex unitary matrix
-<span class="math inline">\(\Sigma\)</span> is a <span class="math inline">\(m \times n\)</span> rectangular diagonal matrix
with non-negative real numbers on the diagonal -<span class="math inline">\(V\)</span> is a <span class="math inline">\(n
\times n\)</span> real or complex unitary matrix.</p>
<p>Notice that:</p>
<ul>
<li>The diagonal entries <span class="math inline">\(\sigma_i\)</span>
of <span class="math inline">\(\Sigma\)</span> are known as the singular
values of <span class="math inline">\(A\)</span>.</li>
<li>The columns of <span class="math inline">\(U\)</span> are called the
left-singular vectors of <span class="math inline">\(A\)</span>.</li>
<li>The columns of <span class="math inline">\(V\)</span> are called the
right-singular vectors of <span class="math inline">\(A\)</span>.</li>
</ul>
<div class="section level3">
<h3 id="simple-singular-values-decomposition">Simple Singular Values Decomposition<a class="anchor" aria-label="anchor" href="#simple-singular-values-decomposition"></a>
</h3>
<p>He have implemented the SVD for R matrices in the function
<code><a href="../reference/bdSVD.html">bdSVD()</a></code>. The method, so far, only allows SVD of real
matrices <span class="math inline">\(A\)</span>. This code illustrate
how to perform such computations:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix simulation</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">413</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n<span class="sc">*</span>n), <span class="at">nrow=</span>n, <span class="at">ncol=</span>n)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># SVD</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>bsvd <span class="ot">&lt;-</span> <span class="fu">bdSVD</span>(A)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Singular values, and right and left singular vectors</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>bsvd<span class="sc">$</span>d[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">44.27037</span> <span class="fl">43.95609</span> <span class="fl">43.31037</span> <span class="fl">43.01980</span> <span class="fl">42.81728</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>bsvd<span class="sc">$</span>u[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>             [,<span class="dv">1</span>]        [,<span class="dv">2</span>]         [,<span class="dv">3</span>]         [,<span class="dv">4</span>]         [,<span class="dv">5</span>]</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,]  <span class="fl">0.028712445</span>  <span class="fl">0.10169472</span>  <span class="fl">0.019783036</span>  <span class="fl">0.032804622</span> <span class="sc">-</span><span class="fl">0.048915416</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,]  <span class="fl">0.001193891</span>  <span class="fl">0.02296487</span>  <span class="fl">0.009024529</span>  <span class="fl">0.059683600</span>  <span class="fl">0.027888834</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span>,] <span class="sc">-</span><span class="fl">0.008878497</span> <span class="sc">-</span><span class="fl">0.02414059</span> <span class="sc">-</span><span class="fl">0.006035909</span> <span class="sc">-</span><span class="fl">0.004867886</span>  <span class="fl">0.024570252</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>[<span class="dv">4</span>,]  <span class="fl">0.037323916</span> <span class="sc">-</span><span class="fl">0.04675198</span>  <span class="fl">0.035928628</span> <span class="sc">-</span><span class="fl">0.021097593</span> <span class="sc">-</span><span class="fl">0.073485962</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>[<span class="dv">5</span>,] <span class="sc">-</span><span class="fl">0.054073083</span>  <span class="fl">0.04382626</span> <span class="sc">-</span><span class="fl">0.009027050</span> <span class="sc">-</span><span class="fl">0.002269443</span> <span class="sc">-</span><span class="fl">0.003071978</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>bsvd<span class="sc">$</span>v[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>            [,<span class="dv">1</span>]        [,<span class="dv">2</span>]        [,<span class="dv">3</span>]        [,<span class="dv">4</span>]         [,<span class="dv">5</span>]</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,] <span class="sc">-</span><span class="fl">0.07105335</span>  <span class="fl">0.04554495</span> <span class="sc">-</span><span class="fl">0.03850442</span>  <span class="fl">0.07270812</span>  <span class="fl">0.078124410</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,]  <span class="fl">0.05989691</span> <span class="sc">-</span><span class="fl">0.02957792</span> <span class="sc">-</span><span class="fl">0.07508850</span> <span class="sc">-</span><span class="fl">0.01171385</span>  <span class="fl">0.001581823</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span>,] <span class="sc">-</span><span class="fl">0.00200688</span> <span class="sc">-</span><span class="fl">0.04179449</span>  <span class="fl">0.02798939</span> <span class="sc">-</span><span class="fl">0.05686766</span> <span class="sc">-</span><span class="fl">0.073573833</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>[<span class="dv">4</span>,] <span class="sc">-</span><span class="fl">0.01284403</span> <span class="sc">-</span><span class="fl">0.05024617</span> <span class="sc">-</span><span class="fl">0.09038993</span> <span class="sc">-</span><span class="fl">0.05725360</span>  <span class="fl">0.023632656</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>[<span class="dv">5</span>,] <span class="sc">-</span><span class="fl">0.01751359</span>  <span class="fl">0.07320492</span> <span class="sc">-</span><span class="fl">0.02120536</span> <span class="sc">-</span><span class="fl">0.02397367</span> <span class="sc">-</span><span class="fl">0.067643671</span></span></code></pre></div>
<p>We get the expected results obtained with standard R functions:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>( <span class="fu">sqrt</span>( <span class="fu">svd</span>( <span class="fu">tcrossprod</span>( <span class="fu">scale</span>(A) ) )<span class="sc">$</span>d[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>] ), bsvd<span class="sc">$</span>d[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>] )</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
<p>you get the <span class="math inline">\(\sigma_i\)</span>, <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span> of normalized matrix <span class="math inline">\(A\)</span>, if you want to perform the SVD from
not normalized matrix <span class="math inline">\(A\)</span> then you
have to set the parameter <code>bcenter = false</code> and
<code>bscale = false</code>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>bsvd <span class="ot">&lt;-</span> <span class="fu">bdSVD</span>(A, <span class="at">bcenter =</span> <span class="cn">FALSE</span>, <span class="at">bscale =</span> <span class="cn">FALSE</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>bsvd<span class="sc">$</span>d[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">44.44007</span> <span class="fl">43.89640</span> <span class="fl">43.38384</span> <span class="fl">43.23563</span> <span class="fl">42.82658</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>bsvd<span class="sc">$</span>u[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>              [,<span class="dv">1</span>]        [,<span class="dv">2</span>]         [,<span class="dv">3</span>]         [,<span class="dv">4</span>]        [,<span class="dv">5</span>]</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,]  <span class="fl">3.075740e-02</span>  <span class="fl">0.09861737</span> <span class="sc">-</span><span class="fl">0.026705796</span>  <span class="fl">0.001569226</span> <span class="sc">-</span><span class="fl">0.04384078</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,]  <span class="fl">6.480471e-05</span>  <span class="fl">0.04151230</span> <span class="sc">-</span><span class="fl">0.049215808</span>  <span class="fl">0.054763599</span> <span class="sc">-</span><span class="fl">0.01436232</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span>,] <span class="sc">-</span><span class="fl">1.857597e-02</span> <span class="sc">-</span><span class="fl">0.02463540</span> <span class="sc">-</span><span class="fl">0.001246071</span>  <span class="fl">0.015838141</span>  <span class="fl">0.05725309</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>[<span class="dv">4</span>,]  <span class="fl">3.555600e-02</span> <span class="sc">-</span><span class="fl">0.05715730</span> <span class="sc">-</span><span class="fl">0.009596880</span> <span class="sc">-</span><span class="fl">0.040247700</span> <span class="sc">-</span><span class="fl">0.03888504</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>[<span class="dv">5</span>,] <span class="sc">-</span><span class="fl">5.290501e-02</span>  <span class="fl">0.04784627</span> <span class="sc">-</span><span class="fl">0.006624289</span>  <span class="fl">0.010168748</span>  <span class="fl">0.01934154</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>bsvd<span class="sc">$</span>v[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>              [,<span class="dv">1</span>]        [,<span class="dv">2</span>]         [,<span class="dv">3</span>]        [,<span class="dv">4</span>]        [,<span class="dv">5</span>]</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,] <span class="sc">-</span><span class="fl">0.0677291931</span>  <span class="fl">0.03646765</span> <span class="sc">-</span><span class="fl">0.072013679</span> <span class="sc">-</span><span class="fl">0.06460296</span>  <span class="fl">0.03834539</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,]  <span class="fl">0.0558086446</span> <span class="sc">-</span><span class="fl">0.02816709</span> <span class="sc">-</span><span class="fl">0.067619533</span>  <span class="fl">0.02478961</span>  <span class="fl">0.01316491</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span>,]  <span class="fl">0.0024305441</span> <span class="sc">-</span><span class="fl">0.04679000</span>  <span class="fl">0.064115513</span>  <span class="fl">0.04134591</span> <span class="sc">-</span><span class="fl">0.03519768</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>[<span class="dv">4</span>,] <span class="sc">-</span><span class="fl">0.0007861777</span> <span class="sc">-</span><span class="fl">0.06602592</span> <span class="sc">-</span><span class="fl">0.062833191</span>  <span class="fl">0.06307396</span>  <span class="fl">0.03651487</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>[<span class="dv">5</span>,] <span class="sc">-</span><span class="fl">0.0165396063</span>  <span class="fl">0.07316212</span>  <span class="fl">0.002600021</span>  <span class="fl">0.07030477</span> <span class="sc">-</span><span class="fl">0.07916813</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>( <span class="fu">sqrt</span>(<span class="fu">svd</span>(<span class="fu">tcrossprod</span>(A))<span class="sc">$</span>d[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]), bsvd<span class="sc">$</span>d[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>] )</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="block-singular-values-decomposition">Block Singular Values Decomposition<a class="anchor" aria-label="anchor" href="#block-singular-values-decomposition"></a>
</h3>
<p>A method developed by M. A. Iwen and B. W. Ong uses a distributed and
incremental SVD algorithm that is useful for agglomerative data analysis
on large networks. The algorithm calculates the singular values and left
singular vectors of a matrix A, by first, partitioning it by columns.
This creates a set of submatrices of A with the same number of rows, but
only some of its columns. After that, the SVD of each of the submatrices
is computed. The final step consists of combining the results obtained
by merging them again and computing the SVD of the resulting matrix.</p>
<p>This approach is only implemented using HDF5 files. This method is
implemented in <code>bdSVD_hdf5</code> function, this function works
directly on hdf5 data format, loading in memory only the data to perform
calculations and saving the results again in the hdf5 file for later
use. The user is referred to read <a href="https://rpubs.com/jrgonzalezISGlobal/BigDatStatMeth_hdf5" class="external-link">section
7.3.1 from this vignette</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="using-algebra-procedure-to-implement-basic-statistical-methods">Using algebra procedure to implement basic statistical methods<a class="anchor" aria-label="anchor" href="#using-algebra-procedure-to-implement-basic-statistical-methods"></a>
</h2>
<div class="section level3">
<h3 id="principal-component-analysis-pca">Principal component analysis (PCA)<a class="anchor" aria-label="anchor" href="#principal-component-analysis-pca"></a>
</h3>
<p>Let us illustrate how to perform a PCA using miRNA data obtained from
TCGA corresponding to 3 different tumors: melanoma (ME), leukemia (LEU)
and centran nervous system (CNS). Data is available at
<code>BigDataStatMeth</code> and can be loaded by simply:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(miRNA)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(cancer)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(miRNA)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="dv">21</span> <span class="dv">537</span></span></code></pre></div>
<p>We observe that there are a total of 21 individuals and 537 miRNAs.
The vector <code>cancer</code> contains the type of tumor of each
individual. For each type we have:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(cancer)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>cancer</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>CNS  LE  ME </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">6</span>   <span class="dv">6</span>   <span class="dv">9</span> </span></code></pre></div>
<p>Now, the typical principal component analysis on the samples can be
run on the <code>miRNA</code> matrix since it has miRNAs in columns and
individuals in rows</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span><span class="va">miRNA</span><span class="op">)</span></span></code></pre></div>
<p>We can plot the two first components with:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pc</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">pc</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"miRNA data on tumor samples"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"PC1"</span>, ylab <span class="op">=</span> <span class="st">"PC2"</span>, type<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>, v<span class="op">=</span><span class="fl">0</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">pc</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">pc</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, col <span class="op">=</span> <span class="va">cancer</span>,</span>
<span>       pch<span class="op">=</span><span class="fl">16</span>, cex<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">16</span>, col<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="BigDataStatMeth_memory_files/figure-html/plot_pca-1.png" width="700"></p>
<p>The PCA is equivalent to performing the SVD on the centered data,
where the centering occurs on the columns. In that case the function
<code>bdSVD</code> requires to set the argument <code>bcenter</code> and
<code>bscale</code> equal to TRUE, the dafault values.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">miRNA.c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sweep.html" class="external-link">sweep</a></span><span class="op">(</span><span class="va">miRNA</span>, <span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">miRNA</span><span class="op">)</span>, <span class="st">"-"</span><span class="op">)</span></span>
<span><span class="va">svd.da</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bdSVD.html">bdSVD</a></span><span class="op">(</span><span class="va">miRNA.c</span>, bcenter <span class="op">=</span> <span class="cn">FALSE</span>, bscale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>The PCA plot for the two principal components can then be be obtained
by:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">svd.da</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">svd.da</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"miRNA data on tumor samples"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"PC1"</span>, ylab <span class="op">=</span> <span class="st">"PC2"</span>, type<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>, v<span class="op">=</span><span class="fl">0</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">svd.da</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">svd.da</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, col <span class="op">=</span> <span class="va">cancer</span>,</span>
<span>       pch<span class="op">=</span><span class="fl">16</span>, cex<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">16</span>, col<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="BigDataStatMeth_memory_files/figure-html/plot_svd_da-1.png" width="700"></p>
<p>We can observe that both figures are equal irrespective to a sign
change of second component (that can happen in SVD).</p>
</div>
</div>
<div class="section level2">
<h2 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>R version <span class="dv">4</span>.<span class="fl">2.1</span> (<span class="dv">2022-06-23</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>Platform<span class="sc">:</span> aarch64<span class="sc">-</span>apple<span class="sc">-</span><span class="fu">darwin20</span> (<span class="dv">64</span><span class="sc">-</span>bit)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>Running under<span class="sc">:</span> macOS Monterey <span class="fl">12.5</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>Matrix products<span class="sc">:</span> default</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>BLAS<span class="sc">:</span>   <span class="er">/</span>Library<span class="sc">/</span>Frameworks<span class="sc">/</span>R.framework<span class="sc">/</span>Versions<span class="sc">/</span><span class="fl">4.2</span><span class="sc">-</span>arm64<span class="sc">/</span>Resources<span class="sc">/</span>lib<span class="sc">/</span>libRblas.<span class="fl">0.</span>dylib</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>LAPACK<span class="sc">:</span> <span class="er">/</span>Library<span class="sc">/</span>Frameworks<span class="sc">/</span>R.framework<span class="sc">/</span>Versions<span class="sc">/</span><span class="fl">4.2</span><span class="sc">-</span>arm64<span class="sc">/</span>Resources<span class="sc">/</span>lib<span class="sc">/</span>libRlapack.dylib</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>locale<span class="sc">:</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] ca_ES.UTF<span class="dv">-8</span><span class="sc">/</span>ca_ES.UTF<span class="dv">-8</span><span class="sc">/</span>ca_ES.UTF<span class="dv">-8</span><span class="sc">/</span>C<span class="sc">/</span>ca_ES.UTF<span class="dv">-8</span><span class="sc">/</span>ca_ES.UTF<span class="dv">-8</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>attached base packages<span class="sc">:</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>other attached packages<span class="sc">:</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] microbenchmark_1.<span class="fl">4.9</span>    ggplot2_3.<span class="fl">3.6</span>           BigDataStatMeth_0.<span class="fl">99.50</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>[<span class="dv">4</span>] Matrix_1<span class="fl">.5</span><span class="dv">-1</span>            rmarkdown_2<span class="fl">.17</span>          knitr_1<span class="fl">.40</span>             </span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>[<span class="dv">7</span>] BiocStyle_2.<span class="fl">24.0</span>       </span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>loaded via a <span class="fu">namespace</span> (and not attached)<span class="sc">:</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] xfun_0<span class="fl">.33</span>           bslib_0.<span class="fl">4.0</span>         purrr_0.<span class="fl">3.5</span>        </span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a> [<span class="dv">4</span>] lattice_0<span class="fl">.20</span><span class="dv">-45</span>     rhdf5_2.<span class="fl">40.0</span>        colorspace_2<span class="fl">.0</span><span class="dv">-3</span>   </span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a> [<span class="dv">7</span>] vctrs_0.<span class="fl">4.2</span>         htmltools_0.<span class="fl">5.3</span>     yaml_2.<span class="fl">3.5</span>         </span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>[<span class="dv">10</span>] utf8_1.<span class="fl">2.2</span>          rlang_1.<span class="fl">0.6</span>         pkgdown_2.<span class="fl">0.6</span>      </span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>[<span class="dv">13</span>] jquerylib_0.<span class="fl">1.4</span>     pillar_1.<span class="fl">8.1</span>        withr_2.<span class="fl">5.0</span>        </span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>[<span class="dv">16</span>] glue_1.<span class="fl">6.2</span>          lifecycle_1.<span class="fl">0.3</span>     stringr_1.<span class="fl">4.1</span>      </span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>[<span class="dv">19</span>] munsell_0.<span class="fl">5.0</span>       gtable_0.<span class="fl">3.1</span>        ragg_1.<span class="fl">2.3</span>         </span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>[<span class="dv">22</span>] memoise_2.<span class="fl">0.1</span>       evaluate_0<span class="fl">.17</span>       labeling_0.<span class="fl">4.2</span>     </span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>[<span class="dv">25</span>] fastmap_1.<span class="fl">1.0</span>       fansi_1.<span class="fl">0.3</span>         highr_0<span class="fl">.9</span>          </span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>[<span class="dv">28</span>] Rcpp_1.<span class="fl">0.9</span>          scales_1.<span class="fl">2.1</span>        BiocManager_1.<span class="fl">30.18</span></span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>[<span class="dv">31</span>] cachem_1.<span class="fl">0.6</span>        desc_1.<span class="fl">4.2</span>          RcppParallel_5.<span class="fl">1.5</span> </span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>[<span class="dv">34</span>] jsonlite_1.<span class="fl">8.2</span>      farver_2.<span class="fl">1.1</span>        systemfonts_1.<span class="fl">0.4</span>  </span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>[<span class="dv">37</span>] fs_1.<span class="fl">5.2</span>            textshaping_0.<span class="fl">3.6</span>   digest_0.<span class="fl">6.29</span>      </span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>[<span class="dv">40</span>] stringi_1.<span class="fl">7.8</span>       bookdown_0<span class="fl">.29</span>       grid_4.<span class="fl">2.1</span>         </span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>[<span class="dv">43</span>] rprojroot_2.<span class="fl">0.3</span>     cli_3.<span class="fl">4.1</span>           tools_4.<span class="fl">2.1</span>        </span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>[<span class="dv">46</span>] bitops_1<span class="fl">.0</span><span class="dv">-7</span>        rhdf5filters_1.<span class="fl">8.0</span>  magrittr_2.<span class="fl">0.3</span>     </span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>[<span class="dv">49</span>] sass_0.<span class="fl">4.2</span>          RCurl_1<span class="fl">.98-1.9</span>      tibble_3.<span class="fl">1.8</span>       </span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>[<span class="dv">52</span>] pkgconfig_2.<span class="fl">0.3</span>     data.table_1.<span class="fl">14.2</span>   rstudioapi_0<span class="fl">.14</span>    </span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>[<span class="dv">55</span>] Rhdf5lib_1.<span class="fl">18.2</span>     R6_2.<span class="fl">5.1</span>            compiler_4.<span class="fl">2.1</span>     </span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Dolors Pelegri-Siso, Juan R. Gonzalez.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
